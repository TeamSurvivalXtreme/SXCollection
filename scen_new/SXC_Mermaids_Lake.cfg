#textdomain wesnoth-SXC
# This map has a lake in it, with a water castle (ai7) at the north edge of the
# lake.  In the map itself this lake is shallow water with fords running through
# it, the WML in this scenario converts all of these to deep water at the start,
# and can later return it to the original terrain.

# My idea is to make the lake boss the final boss, with recruits that can easily
# move through the lake, but the lake being a barrier to the players, who start
# on the southern edge of the map.  This is not expected to be a puzzle to the
# players, the standard SXC gameplay of attacking the bosses that they can reach
# will change the terrain so that the final boss can be attacked.

# If the players head towards the north-east leader, they'll see the
# north-eastern river, defeating the guards on the river will lower the water
# level.

# If the players head towards the north-west, they'll get access to the northern
# part of the map and the north-eastern stream, playtesting will see if there
# needs to be an additional ways to get access to the lake from there.

# Alternatively, players can find a way to drain the lake in the south-west
# corner.

# The south-west caves are inaccessible until I have a use for them

# Both northern bosses and the lake boss are expected to survive until the
# endgame, which is also about the time that the players have explored the map.
# All three bosses are then expected to be defeated in a few turns; once any of
# them is defeated then the players should have enough gold to finish the
# endgame quickly.

[multiplayer]
  id=SXC_Mermaids_Lake_{SXC_VERSION}
  name="SXC Mermaid's Lake {SXC_VERSION}"
  map_file="SXC_Mermaids_Lake.map"
  description={SXC_MAP_DEFAULT_DESCRIPTION}
# For Wesnoth 1.13, data/core/images/portraits/undead/zombie-swimmer.webp would be better
  {SXC_DEFAULT_MAP_SETTINGS 150 "lose" "data/core/images/portraits/merfolk/priestess.webp" "<span color='#BCB088' weight='bold' face='roman'>This area was once a thermal spa, where warm water formed a lake before flowing back underground. Over time the dwarves took over the warmest corner, with other groups claiming their own areas; recently dark sorcery has taken over the lake, and the undead swim in it. You start with only one unit, but you can enhance it during the game. Have fun and good luck!</span>"}

#  {SXC_TEST_PLAYER_SIDE_2 1 800 (color=red)}
#  {SXC_TEST_PLAYER_SIDE_2 2 800 (color=blue)}
#  {SXC_TEST_PLAYER_SIDE_2 3 800 (color=green)}
#  {SXC_TEST_PLAYER_SIDE_2 4 800 (color=orange)}
#  {SXC_TEST_PLAYER_SIDE_2 5 800 (color=teal)}

  {SXC_PLAYER_SIDE_2 1 800 (color=red)}
  {SXC_PLAYER_SIDE_2 2 800 (color=blue)}
  {SXC_PLAYER_SIDE_2 3 800 (color=green)}
  {SXC_PLAYER_SIDE_2 4 800 (color=orange)}
  {SXC_PLAYER_SIDE_2 5 800 (color=teal)}

  # This side's upgraded recruit lists come from SXC_System's side 7
  {SXC_ENEMY_SIDE 6 200 35 "Drake Burner,Drake Clasher,Drake Glider,Drake Fighter,Saurian Skirmisher,Saurian Augur" (
    color=black
    name=Boss
  ) "Armageddon Drake" 902 4 25 0 28 30 BLANK BLANK BLANK BLANK}
  # The mermaid is the final boss (and she's a necromancer)
  # Notes on the recruitment list:
  # The L2 Deathblade is a max-level char, and stays recruitable until the end of the game
  # The L3 Diviner illuminates, so isn't in the list even though her L1 and L2 are
  {SXC_ENEMY_SIDE 7 300 40 "Ghost,Skeleton,Skeleton Archer,Merman Fighter,Merman Hunter,Mermaid Initiate,Mage" (
    color=black
    name=Boss
  ) "Mermaid Priestess" 2942 6 43 7 46 50 BLANK BLANK BLANK BLANK}
  {SXC_ENEMY_SIDE 8 400 45 "Orcish Archer,Orcish Grunt,Troll Whelp,Wolf Rider" (
    color=black
    name=Boss
  ) "Orcish Sovereign" 1925 6 50 7 51 50 BLANK BLANK BLANK BLANK}
  # This side's recruit lists (and upgraded recruit lists) come from SXC_System's side 9
  # Although this is not the final boss for Mermaid's Lake, as the map is larger and doesn't have the
  # cashstop setting of SXC_System, it seems likely that SXC_System's stats will be a good starting
  # point for balancing the map
  {SXC_ENEMY_SIDE 9 250 48 "Dwarvish Fighter,Dwarvish Guardsman,Dwarvish Scout,Dwarvish Thunderer,Dwarvish Ulfserker,Gryphon Rider" (
    color=black
    name=Boss
  ) "Dwarvish Lord" 2921 17 55 18 60 60 RC BLANK BLANK BLANK}

  [event]
    name=prestart
    {SXC_INIT_VARIABLES}
    {VARIABLE brutal 10}
  [/event]

#define SXCP_ANCIENT_WOSE X Y
    {SXC_ENEMY_GUARD_CHANGE_ATTACK {X} {Y} 6 1 (
      set_description=_ "entangle"
    )}
    {SXC_ENEMY_GUARD_SET_SPECIALS {X} {Y} 6 0 append {WEAPON_SPECIAL_MAGICAL} {BLANK}}
    {SXC_ENEMY_GUARD_SET_SPECIALS {X} {Y} 6 1 append {WEAPON_SPECIAL_SLOW} {BLANK}}
    {SXC_ENEMY_GUARD_REMOVE_ABILITY {X} {Y} 6 ambush}
#enddef

  [event]
    name=start
    {SXC_ARMORY_LIMITS_AND_EMPTY_SIDES}
    {SXC_HIDE_HEROES_UNTIL_THEY_MOVE}

    {SXC_BEFORE_SHOPS}
    {SXC_SHOP_2 2 19 "terrain/village/human-city3.png"}
    {SXC_SHOP_2 25 48 "terrain/village/dwarven2.png"}
    {SXC_SHOP_2 33 5 "terrain/village/elven2.png"}
    {SXC_SHOP_2 40 31 "terrain/village/swampwater.png"}
    {SXC_SHOP_EVENT}

    # chests with gold amounts that aren't a multiple of 25 are places that
    # should have something more interesting than gold

    # north-west orcs
    {SXC_CHEST_GOLD 2 14 125}
    # The orc boss' treasure trail
    {SXC_CHEST_GOLD 6 2 500}
    {SXC_CHEST_GOLD 1 8 125}
    {SXC_CHEST_GOLD 11 8 125}
    {SXC_CHEST_GOLD 14 8 125}
    {SXC_DEFRING 17 9} # This is the end of the orc boss' button trail

    # west (but not part of the orcs' area)
    {SXC_CHEST_GOLD 1 17 250} # Next to a nightgaunt, one hex south of it
    {SXC_CHEST_GOLD 2 29 50}
    {SXC_CHEST_GOLD 18 17 100}
    {SXC_CHEST_GOLD 18 25 100}

    # north shop and caves
    {SXC_RED_POTION 27 6}
    {SXC_YELLOW_POTION 28 2}
    {SXC_CHEST_GOLD 29 2 125}
    {SXC_CHEST_GOLD 11 37 125}
    {SXC_CHEST_GOLD 35 2 25} # just to entice players to trigger the switch

    # south-west (area is mostly inaccessible)
    {SXC_CHEST_GOLD 21 44 50} # tiny cave west of entrance

    # south-east and drakes
    {SXC_CHEST_GOLD 38 48 100} # saurian at the east side of the caves
    {SXC_CHEST_GOLD 29 43 100} # ghost in the caves
    {SXC_CHEST_GOLD 34 42 100} # spider in the caves
    {SXC_CHEST_GOLD 47 49 100} # the drake boss
    {SXC_CHEST_GOLD 49 44 300} # the drakes' treasury

    # dwarves
    {SXC_CHEST_GOLD 50 8 500} # the dwarven treasury (opened by standing on either of the forts)
    {SXC_CHEST_GOLD 38 1 500} # the dwarven boss himself

    # lake and merfolk
    {SXC_CHEST_GOLD 43 9 25} # stream-chasm sluice, chest is to ensure players trigger the switch
    {SXC_CHEST_GOLD 41 13 25} # stream-chasm sluice, chest is to ensure players trigger the switch
    {SXC_CHEST_GOLD 33 19 500} # the mermaid

    {SXC_DEFRING 19 27}
    {SXC_RESRING 41 27}
    {SXC_RESRING 1 25}
    {SXC_RED_POTION 21 26}
    {SXC_RED_POTION 26 22}
    {SXC_YELLOW_POTION 32 27}
    {SXC_YELLOW_POTION 45 37}

    {SXC_ENEMY_GUARD_3 S none 13 37 "Wose" 6 1 28 1 10 1 7 30 RI BLANK BLANK BLANK}
    {SXCP_ANCIENT_WOSE 13 37}
    {SXC_ENEMY_GUARD_3 S none 16 34 "Wose" 6 1 28 1 10 1 7 30 RI BLANK BLANK BLANK}
    {SXCP_ANCIENT_WOSE 16 34}
    {SXC_ENEMY_GUARD_3 S none 21 35 "Wose" 6 1 28 1 10 1 7 30 RI BLANK BLANK BLANK}
    {SXCP_ANCIENT_WOSE 21 35}
    {SXC_ENEMY_GUARD_3 S none 21 33 "Ancient Wose" 6 1 120 2 15 2 12 30 RI BLANK BLANK BLANK}
    {SXCP_ANCIENT_WOSE 21 33}
    {SXC_ENEMY_GUARD_3 S none 24 33 "Ancient Wose" 6 1 120 2 15 2 12 30 RI BLANK BLANK BLANK}
    {SXCP_ANCIENT_WOSE 24 33}
    {SXC_ENEMY_GUARD_3 S none 27 34 "Ancient Wose" 6 1 120 2 15 2 12 30 RI BLANK BLANK BLANK}
    {SXCP_ANCIENT_WOSE 27 34}
    {SXC_ENEMY_GUARD_3 S none 41 25 "Ancient Wose" 6 1 120 2 15 2 12 30 RI BLANK BLANK BLANK}
    {SXCP_ANCIENT_WOSE 41 25}
    {SXC_ENEMY_GUARD_3 S none 43 29 "Wose" 6 1 28 1 10 1 7 30 RI BLANK BLANK BLANK}
    {SXCP_ANCIENT_WOSE 43 29}
    {SXC_ENEMY_GUARD_3 S none 49 29 "Wose" 6 1 28 1 10 1 7 30 RI BLANK BLANK BLANK}
    {SXCP_ANCIENT_WOSE 49 29}
    {SXC_ENEMY_GUARD_3 S none 25 24 "Tentacle of the Deep" 7 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_REMOVE_ABILITY 25 24 7 submerge}
    {SXC_ENEMY_GUARD_3 S none 28 19 "Tentacle of the Deep" 7 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_REMOVE_ABILITY 28 19 7 submerge}
    {SXC_ENEMY_GUARD_3 S none 37 20 "Tentacle of the Deep" 7 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_REMOVE_ABILITY 37 20 7 submerge}
    {SXC_ENEMY_GUARD_3 S none 21 43 "Goblin Rouser" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 21 44 "Goblin Pillager" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK} # chest
    {SXC_ENEMY_GUARD_3 S none 18 27 "Cuttle Fish" 7 1 333 0 12 3 9 20 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 20 27 "Cuttle Fish" 7 1 333 0 12 3 9 20 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 29 24 "Cuttle Fish" 7 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 35 24 "Cuttle Fish" 7 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 30 21 "Merman Entangler" 7 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 36 21 "Merman Entangler" 7 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    # The south-west sluice is near the starting point, but as it's the end of
    # the map it has a strong merman guard. This sea-serpent is a buffer with
    # strong defense but weak attacks, so that players who aren't checking the
    # combat stats don't accidentally suicide on the merman.
    {SXC_ENEMY_GUARD_3 S none 19 41 "Sea Serpent" 7 1 415 0 0 0 0 50 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 30 44 "Sea Serpent" 7 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 27 38 "Elvish Ranger" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_REMOVE_ABILITY 27 38 6 ambush}
    {SXC_ENEMY_GUARD_3 S none 23 43 "Rogue" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 27 43 "Rogue" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 23 44 "Outlaw" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 27 44 "Outlaw" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 34 42 "Giant Spider" 9 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 29 43 "Ghost" 9 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK} # chest
    {SXC_ENEMY_GUARD_3 S none 30 48 "Ghoul" 9 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 49 44 "Saurian Oracle" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    # Guard on the starting room, removed because it's a choke point
    # {SXC_ENEMY_GUARD_3 S none 25 42 "Huntsman" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 23 46 "Poacher" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 27 46 "Footpad" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 34 44 "Saurian Soothsayer" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK} # chest
    {SXC_ENEMY_GUARD_3 S none 35 48 "Saurian Flanker" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK} # chest
    {SXC_ENEMY_GUARD_3 S none 38 48 "Saurian Oracle" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}

    # south-west cave, currently unused
#ifdef SXCP_SOUTH_WEST_CAVE
    {SXC_ENEMY_GUARD_3 S none 20 45 "Direwolf Rider" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 20 46 "Orcish Slurbow" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 7 46 "Orcish Slayer" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 8 45 "Troll Shaman" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 2 36 "Orcish Warlord" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 6 35 "Orcish Slayer" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 6 38 "Giant Spider" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 6 40 "Cuttle Fish" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 3 46 "Troll Rocklobber" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 4 47 "Goblin Impaler" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 7 49 "Goblin Rouser" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 16 46 "Water Serpent" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 7 42 "Tentacle of the Deep" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 9 40 "Tentacle of the Deep" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 9 44 "Tentacle of the Deep" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 9 34 "Orcish Archer" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 14 45 "Orcish Assassin" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 3 43 "Ogre" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 18 43 "Troll Hero" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 18 49 "Orcish Crossbowman" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
#endif

    {SXC_ENEMY_GUARD_3 S none 43 44 "Saurian Ambusher" 6 1 500 2 10 2 10 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 44 40 "Hurricane Drake" 6 1 200 2 10 2 10 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 47 42 "Saurian Augur" 6 1 500 5 15 5 15 20 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 48 35 "Saurian Oracle" 6 1 500 5 15 5 15 20 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 39 41 "Drake Glider" 6 1 200 2 10 2 10 20 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 40 38 "Drake Burner" 6 1 200 2 10 2 10 20 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 41 27 "Dwarvish Sentinel" 6 1 200 2 10 2 10 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 32 27 "Fugitive" 6 1 238 2 15 2 15 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 11 37 "Dwarvish Dragonguard" 6 1 141 1 11 1 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 11 31 "Troll Shaman" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 M none 2 29 "Orcish Crossbowman" 8 8 57 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 M none 2 30 "Orcish Warrior" 8 8 42 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 8 26 "Giant Spider" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 M none 8 20 "Giant Spider" 8 5 96 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S cave 10 21 "Troll Rocklobber" 8 5 151 1 28 3 19 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S cave 10 25 "Troll" 8 5 195 3 23 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 7 24 "Orcish Assassin" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 4 25 "Tentacle of the Deep" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 1 25 "Orcish Slurbow" 8 1 194 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 1 22 "Orcish Slayer" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 1 16 "Nightgaunt" 9 1 350 2 40 2 40 10 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 M none 5 18 "Direwolf Rider" 8 8 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 M none 3 17 "Goblin Knight" 8 8 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 M none 7 17 "Goblin Pillager" 8 8 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 2 14 "Goblin Rouser" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 2 13 "Goblin Impaler" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 3 15 "Wolf Rider" 8 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 6 9 "Orcish Slayer" 8 1 364 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 5 9 "Orcish Warlord" 8 1 422 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 7 9 "Orcish Warlord" 8 1 422 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 6 6 "Orcish Slayer" 8 1 364 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 5 7 "Orcish Slurbow" 8 1 394 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 7 7 "Orcish Slurbow" 8 1 394 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 14 26 "Orcish Assassin" 8 1 174 2 10 0 16 30 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 13 26 "Orcish Warrior" 8 1 242 1 28 0 0 10 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 15 26 "Orcish Warrior" 8 1 242 1 28 0 0 10 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 10 18 "Orcish Crossbowman" 8 1 457 0 20 2 30 10 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 16 17 "Orcish Crossbowman" 8 1 457 0 20 2 30 10 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 13 5 "Orcish Slurbow" 8 1 194 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 17 15 "Orcish Crossbowman" 8 1 457 0 20 2 30 10 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 19 5 "Orcish Warlord" 8 1 222 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 14 8 "Orcish Warlord" 8 1 222 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 22 5 "Orcish Crossbowman" 8 1 457 0 20 2 30 10 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 22 7 "Orcish Crossbowman" 8 1 457 0 20 2 30 10 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 18 17 "Assassin" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 18 25 "Assassin" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 20 18 "Fugitive" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 20 24 "Fugitive" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 22 19 "Highwayman" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 22 23 "Highwayman" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 23 21 "Huntsman" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 23 22 "Huntsman" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 M none 27 6 "Giant Spider" 9 2 146 2 12 1 22 0 BLANK BLANK BLANK BLANK}

    # Dwarves, and guards of the north-east
    {SXC_ENEMY_GUARD_3 S none 47 21 "Dwarvish Sentinel" 9 1 164 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 46 20 "Dwarvish Steelclad" 9 1 222 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 48 20 "Dwarvish Steelclad" 9 1 222 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 46 16 "Dwarvish Steelclad" 9 1 322 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 48 16 "Dwarvish Steelclad" 9 1 322 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 47 12 "Dwarvish Steelclad" 9 1 322 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 46 12 "Dwarvish Sentinel" 9 1 464 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 48 12 "Dwarvish Sentinel" 9 1 464 2 20 2 20 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 38 6 "Dwarvish Sentinel" 9 1 932 4 41 5 39 0 BLANK BLANK BLANK BLANK}

    # These guards are standing on encampments, which act as dams. Killing them and
    # opening the dam will lower the river.
    {SXC_ENEMY_GUARD_3 S none 43 9 "Merman Entangler" 7 1 945 5 57 5 57 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 41 13 "Merman Entangler" 7 1 945 5 57 5 57 0 BLANK BLANK BLANK BLANK}
    # Guard for the south-west sluice
    {SXC_ENEMY_GUARD_3 S none 18 41 "Merman Entangler" 7 1 1445 5 57 5 57 0 BLANK BLANK BLANK BLANK}

    {SXC_ENEMY_LEADER_ADD_ABILITY 7 ({ABILITY_SXC_DARKAURA})}
    {SXC_ENEMY_LEADER_ADD_ABILITY 7 ({ABILITY_SXC_REGENERATESX 250})}
  [/event]

  [event]
    name=new turn
    first_time_only=no
    {VARIABLE_OP brutal add 1}
  [/event]

  # The lake's water level can change, these events and macros control that

  # Set up variables with lists of hexes that are part of each area.
  [event]
    name=prestart
    # These two hexes are where the north-eastern stream is next to a chasm. Change each in to
    # a dam before the macros that use terrain-types to find the water.
    {MODIFY_TERRAIN Chw 43 9}
    {MODIFY_TERRAIN Chw 41 13}
    # And the south-west sluice
    {MODIFY_TERRAIN Chw 18 41}
    # As a hint to the players, use similar hexes for the cuttlefish cave
    {MODIFY_TERRAIN Qxu 18 29}
    {MODIFY_TERRAIN Chw 19 29}

    # sxcp_originally_stream is the water north of the mermaid, which looks
    # like a stream feeding the lake
    [store_locations]
      variable=sxcp_originally_stream
      terrain=Ww*
      [and]
        x=32-43
        y=9-16
      [/and]
    [/store_locations]
    # sxcp_castle_north_moat is between the stream and the castle, if it's
    # deep_water then only flying and swimming heroes can get to the boss
    [store_locations]
      variable=sxcp_castle_north_moat
      terrain=Ww*
      [and]
        x=31-35
        y=17-19
      [/and]
    [/store_locations]
    # cuttlefish_cave is where the "drain control" label was
    [store_locations]
      variable=sxcp_cuttlefish_cave
      terrain=W*
      [and]
        x=18-20
        y=27-28
      [/and]
    [/store_locations]
    [store_locations]
      variable=sxcp_cuttlefish_cave_originally_shallow
      terrain=Ww*
      [and]
        find_in=sxcp_cuttlefish_cave
      [/and]
    [/store_locations]
    # now the lake itself
    [store_locations]
      variable=sxcp_originally_shallow_water
      terrain=Ww
      [and]
        x=18-43
        y=17-41
      [/and]
      [not]
        find_in=sxcp_castle_north_moat
      [/not]
      [not]
        find_in=sxcp_cuttlefish_cave
      [/not]
    [/store_locations]
    [store_locations]
      variable=sxcp_originally_ford
      terrain=Wwf
      [and]
        x=18-43
        y=17-41
      [/and]
      [not]
        find_in=sxcp_castle_north_moat
      [/not]
      [not]
        find_in=sxcp_cuttlefish_cave
      [/not]
    [/store_locations]
    {VARIABLE sxcp_stream_sluice_open no}
    {VARIABLE sxcp_lake_sluice_open no}
  [/event]

#define SXCP_CHOOSE_MAP_VARIANT X Y
  [event]
    name=prestart
    {VARIABLE sxcp_map_variant_text ""}
  [/event]

  [event]
    name=moveto
    first_time_only=yes
    [filter]
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [message]
      speaker=narrator
      message=_ "Choose the variantion of this map to play. All variations can be completed with any normal hero's default movement types, but the variant will affect how easy it is to move around the map at the start. The normal difficulty levels (rookie, advanced, xtreme, mad mode) can be selected in the next dialog."
      [option]
        image="icons/shallow-water-buy.png"
        label=_ "Shallow Water (easier)"
        [command]
          {VARIABLE sxcp_map_variant_text "Variant: Shallow Water"}
          {VARIABLE sxcp_lake_sluice_open yes}
        [/command]
      [/option]
      [option]
        default=yes
        image="icons/deep-water-buy.png"
        label=_ "Mermaid's Lake (harder)"
        [command]
          {VARIABLE sxcp_map_variant_text "Variant: Mermaid's Lake"}
          {VARIABLE sxcp_lake_sluice_open no}
        [/command]
      [/option]
      image=wesnoth-icon.png
    [/message]
    [print]
      text="$sxcp_map_variant_text|"
      size=24
      duration=500
      red,green,blue=255,255,0
    [/print]
    [fire_event]
      name=sxcp_recalculate_lake_and_stream_water_levels
    [/fire_event]
    [fire_event]
      name=sxcp_variant_chosen
    [/fire_event]
    [redraw]
    [/redraw]
    [label]
      x={X}
      y={Y}
      text="$sxcp_map_variant_text|"
    [/label]
    [delay]
      time=1000
    [/delay]
  [/event]

  [event]
    name=side turn
    first_time_only=no
    [label]
      x={X}
      y={Y}
      text="$sxcp_map_variant_text|"
    [/label]
  [/event]
#enddef

#define SXCP_SET_WATER_LEVELS STREAM NORTH_MOAT LAKE_FORD LAKE_SHALLOW
    {FOREACH sxcp_originally_stream i}
      {MODIFY_TERRAIN {STREAM} $sxcp_originally_stream[$i].x $sxcp_originally_stream[$i].y}
    {NEXT i}
    {FOREACH sxcp_castle_north_moat i}
      {MODIFY_TERRAIN {NORTH_MOAT} $sxcp_castle_north_moat[$i].x $sxcp_castle_north_moat[$i].y}
    {NEXT i}
    {FOREACH sxcp_originally_ford i}
      {MODIFY_TERRAIN {LAKE_FORD} $sxcp_originally_ford[$i].x $sxcp_originally_ford[$i].y}
    {NEXT i}
    {FOREACH sxcp_originally_shallow_water i}
      {MODIFY_TERRAIN {LAKE_SHALLOW} $sxcp_originally_shallow_water[$i].x $sxcp_originally_shallow_water[$i].y}
    {NEXT i}
    {CLEAR_VARIABLE i}
    {SXC_REDRAW_TERRAIN}
#enddef

  [event]
    name=sxcp_recalculate_lake_and_stream_water_levels
    first_time_only=no
    [if]
      {SXC_CMP sxcp_lake_sluice_open boolean_equals yes}
      [then]
        [fire_event]
          name=sxcp_water_lake_forded
        [/fire_event]
      [/then]
      [else]
        [if]
          {SXC_CMP sxcp_stream_sluice_open boolean_equals yes}
          [then]
            [fire_event]
              name=sxcp_water_north_moat_forded
            [/fire_event]
          [/then]
          [else]
            [fire_event]
              name=sxcp_water_deepest
            [/fire_event]
          [/else]
        [/if]
      [/else]
    [/if]
  [/event]

  [event]
    name=sxcp_water_lake_forded
    first_time_only=no
    {SXCP_SET_WATER_LEVELS Wwf Wwf Wwf Ww}
  [/event]

  [event]
    name=sxcp_water_north_moat_forded
    first_time_only=no
    {SXCP_SET_WATER_LEVELS Wwf Wwf Wwg Wo}
  [/event]

  [event]
    name=sxcp_water_deepest
    first_time_only=no
    {SXCP_SET_WATER_LEVELS Ww Wo Wog Wo}
  [/event]

#define SXCP_SET_CUTTLEFISH_CAVE_WATER_LEVEL LEVEL
    {FOREACH sxcp_cuttlefish_cave_originally_shallow i}
      {MODIFY_TERRAIN {LEVEL} $sxcp_cuttlefish_cave_originally_shallow[$i].x $sxcp_cuttlefish_cave_originally_shallow[$i].y}
    {NEXT i}
    {CLEAR_VARIABLE i}
    {SXC_REDRAW_TERRAIN}
#enddef

  [event]
    name=sxcp_water_cuttlefish_cave_drained
    first_time_only=no
    {SXCP_SET_CUTTLEFISH_CAVE_WATER_LEVEL Wwf}
  [/event]

  [event]
    name=sxcp_water_cuttlefish_cave_deepest
    first_time_only=no
    {SXCP_SET_CUTTLEFISH_CAVE_WATER_LEVEL Wo}
  [/event]

  # start the map with the lake full, and the cuttlefish happy
  [event]
    name=start
    [fire_event]
      name=sxcp_recalculate_lake_and_stream_water_levels
    [/fire_event]
    [fire_event]
      name=sxcp_water_cuttlefish_cave_deepest
    [/fire_event]
  [/event]

  # all creeps recruited by the mermaid can swim
  [event]
    name=recruit
    first_time_only=no
    [filter]
      x=$x1
      y=$y1
      [and]
        side=7
      [/and]
    [/filter]
    [object]
      silent=yes
      [effect]
        apply_to=movement_costs
        replace=yes
        [movement_costs]
          deep_water=1
          shallow_water=1
        [/movement_costs]
      [/effect]
    [/object]
  [/event]

  # all trolls recruited by the orc are berserk (if the map uses AE then it would use
  # the Barbarian Berserker line instead)
  [event]
    name=recruit
    first_time_only=no
    [filter]
      x=$x1
      y=$y1
      [and]
        side=8
      [/and]
      [and]
        type=Troll Whelp,Troll,Troll Warrior,Troll Hero,Great Troll
      [/and]
    [/filter]
    [object]
      silent=yes
      [effect]
        apply_to=attack
        range=melee
        [set_specials]
          mode=replace
          {WEAPON_SPECIAL_BERSERK}
        [/set_specials]
      [/effect]
    [/object]
  [/event]

  # the heroes might not be able to swim, so unshroud the castle as a hint (maybe this should
  # happen when they get to the north of the castle)
  [event]
    name=sxcp_variant_chosen_mermaids_lake
    [remove_shroud]
      [filter_side]
        team_name=Heroes
      [/filter_side]
      x,y=33,20
      radius=3
    [/remove_shroud]
    {SET_LABEL 33 21 "This map doesn't need deep-water movement"}
  [/event]

  [event]
    name=sxcp_variant_chosen_shallow_water

    # In the shallow-water variant, playtesters seem to kill recruits on the mermaid's castle, but
    # then go back south without going to the shop. This version is meant to be easier and faster
    # because you can get the gold in the north caves earlier.  Add some extra chests to entice
    # players up there.
    {SXC_CHEST_GOLD 35 7 100}
    {SXC_CHEST_GOLD 30 10 100}
    {SXC_ENEMY_GUARD_3 S none 35 7 "Rogue" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_GUARD_3 S none 30 10 "Outlaw" 6 1 0 0 0 0 0 0 BLANK BLANK BLANK BLANK}
  [/event]

  [event]
    name=sxcp_variant_chosen
    [if]
      {SXC_CMP sxcp_lake_sluice_open boolean_equals yes}
      [then]
        [fire_event]
          name=sxcp_variant_chosen_shallow_water
        [/fire_event]
      [/then]
      [else]
        [fire_event]
          name=sxcp_variant_chosen_mermaids_lake
        [/fire_event]
      [/else]
    [/if]
  [/event]


  [event]
    name=turn 1
    # Some submerged units, to warn the players that there will be more
    {SCATTER_UNITS 5 "Skeleton,Skeleton Archer" 1 (
      terrain=Wo
      x=24-38
      y=29-35
      [not]
        [filter]
        [/filter]
      [/not]
    ) (
      side=7
      generate_name=no
      random_traits=no
      [modifications]
        {TRAIT_SXC_LOYAL}
      [/modifications]
    )}
    {SCATTER_UNITS 20 "Goblin Impaler,Goblin Rouser,Orcish Archer,Orcish Assassin,Orcish Grunt,Orcish Leader" 1 (
      terrain=Re
      x=4-21
      y=10-25
      [not]
        [filter]
        [/filter]
      [/not]
    ) (
      side=8
      generate_name=yes
      random_traits=yes
      [modifications]
        {TRAIT_SXC_LOYAL}
      [/modifications]
    )}
    {SCATTER_UNITS 10 "Dwarvish Fighter,Dwarvish Guardsman,Dwarvish Scout,Dwarvish Thunderer" 1 (
      terrain=Cud
      x=46-49
      y=2-21
      [not]
        [filter]
        [/filter]
      [/not]
    ) (
      side=9
      generate_name=yes
      random_traits=yes
      [modifications]
        {TRAIT_SXC_LOYAL}
      [/modifications]
    )}
    {SCATTER_UNITS 10 "Dwarvish Fighter,Dwarvish Guardsman,Dwarvish Scout,Dwarvish Thunderer,Dwarvish Ulfserker,Gryphon Rider" 1 (
      terrain=Gg
      x=42-49
      y=21-34
      [not]
        [filter]
        [/filter]
      [/not]
    ) (
      side=9
      generate_name=yes
      random_traits=yes
      [modifications]
        {TRAIT_SXC_LOYAL}
      [/modifications]
    )}
  [/event]

  [event]
    name=turn 10
    [allow_recruit]
      side=6
      type="Drake Arbiter,Drake Flare,Drake Thrasher,Drake Warrior,Fire Drake,Sky Drake,Naga Warrior,Saurian Ambusher,Saurian Oracle,Saurian Soothsayer"
    [/allow_recruit]
    [allow_recruit]
      side=7
      type="Wraith,Shadow,Revenant,Deathblade,Bone Shooter,Merman Warrior,Merman Spearman,Merman Netcaster,Mermaid Priestess"
    [/allow_recruit]
    [allow_recruit]
      side=8
      type="Orcish Ruler,Orcish Crossbowman,Orcish Warrior,Goblin Knight,Goblin Pillager"
    [/allow_recruit]
    [allow_recruit]
      side=9
      type="Dwarvish Berserker,Dwarvish Pathfinder,Dwarvish Stalwart,Dwarvish Steelclad,Dwarvish Thunderguard,Gryphon Master"
    [/allow_recruit]
    {SXC_MODIFY_INCOME 6 40}
    {SXC_MODIFY_INCOME 7 60}
    {SXC_MODIFY_INCOME 8 60}
    {SXC_MODIFY_INCOME 9 70}
  [/event]

  [event]
    name=turn 20
    [allow_recruit]
      side=6
      type="Drake Blademaster,Drake Enforcer,Drake Flameheart,Drake Warden,Hurricane Drake,Inferno Drake,Naga Myrmidon,Saurian Flanker"
    [/allow_recruit]
    [allow_recruit]
      side=7
      type="Spectre,Nightgaunt,Draug,Banebow,Merman Triton,Merman Hoplite,Merman Javelineer,Merman Entangler"
      # The L3 Diviner illuminates, so isn't in the list even though her L1 and L2 are
    [/allow_recruit]
    [allow_recruit]
      side=8
      type="Orcish Sovereign,Orcish Slurbow,Orcish Warlord,Troll,Direwolf Rider"
      # The berserker L2 trolls are treated as if they were L3 here
    [/allow_recruit]
    [allow_recruit]
      side=9
      type="Dwarvish Dragonguard,Dwarvish Explorer,Dwarvish Lord,Dwarvish Runemaster,Dwarvish Sentinel"
    [/allow_recruit]
    {SXC_MODIFY_INCOME 6 45}
    {SXC_MODIFY_INCOME 7 75}
    {SXC_MODIFY_INCOME 8 75}
    {SXC_MODIFY_INCOME 9 90}
  [/event]

  [event]
    name=turn 30
    [allow_recruit]
      side=6
      type="Armageddon Drake"
    [/allow_recruit]
    [disallow_recruit]
      side=6
      type="Drake Burner,Drake Clasher,Drake Fighter,Drake Glider,Naga Fighter,Saurian Augur,Saurian Skirmisher"
    [/disallow_recruit]
    [disallow_recruit]
      side=7
      type="Ghost,Skeleton,Skeleton Archer,Merman Fighter,Merman Hunter,Mermaid Initiate,Mage"
    [/disallow_recruit]
    [disallow_recruit]
      side=8
      type="Orcish Archer,Orcish Grunt,Troll Whelp,Wolf Rider"
    [/disallow_recruit]
    [disallow_recruit]
      side=9
      type="Dwarvish Fighter,Dwarvish Guardsman,Dwarvish Scout,Dwarvish Thunderer,Dwarvish Ulfserker,Gryphon Rider"
    [/disallow_recruit]
    {SXC_MODIFY_INCOME 6 50}
    {SXC_MODIFY_INCOME 7 90}
    {SXC_MODIFY_INCOME 8 90}
    {SXC_MODIFY_INCOME 9 110}
  [/event]

  [event]
    name=turn 40
    [allow_recruit]
      side=7
      type="Skeletal Dragon"
    [/allow_recruit]
    [allow_recruit]
      side=8
      type="Troll Warrior,Troll Hero"
    [/allow_recruit]
    [disallow_recruit]
      side=6
      type="Drake Arbiter,Drake Flare,Drake Thrasher,Drake Warrior,Fire Drake,Sky Drake,Naga Warrior,Saurian Ambusher,Saurian Oracle,Saurian Soothsayer"
    [/disallow_recruit]
    [disallow_recruit]
      side=7
      type="Wraith,Shadow,Revenant,Bone Shooter,Merman Warrior,Merman Spearman,Merman Netcaster,Mermaid Priestess"
      # Deathblade is still allowed as there's no L3 for it
    [/disallow_recruit]
    [disallow_recruit]
      side=8
      type="Orcish Ruler,Orcish Crossbowman,Orcish Warrior,Goblin Knight,Troll"
      # All of the L2s that don't have an L3 are still recruitable
    [/disallow_recruit]
    [disallow_recruit]
      side=9
      type="Dwarvish Pathfinder,Dwarvish Stalwart,Dwarvish Steelclad,Dwarvish Thunderguard"
      # Leave Ulfs recruitable, as they're dangerous for ranged players, and Gryphons
    [/disallow_recruit]
    {SXC_MODIFY_INCOME 6 55}
    {SXC_MODIFY_INCOME 7 105}
    {SXC_MODIFY_INCOME 8 105}
    {SXC_MODIFY_INCOME 9 130}
  [/event]

  [event]
    name=turn 50
    {SXC_MODIFY_INCOME 6 60}
    {SXC_MODIFY_INCOME 7 120}
    {SXC_MODIFY_INCOME 8 120}
    {SXC_MODIFY_INCOME 9 150}
  [/event]

  [event]
    name=turn 60
    {SXC_MODIFY_INCOME 6 65}
    {SXC_MODIFY_INCOME 7 135}
    {SXC_MODIFY_INCOME 8 135}
    {SXC_MODIFY_INCOME 9 170}
  [/event]

  [event]
    name=turn 70
    {SXC_MODIFY_INCOME 6 70}
    {SXC_MODIFY_INCOME 7 150}
    {SXC_MODIFY_INCOME 8 150}
    {SXC_MODIFY_INCOME 9 190}
  [/event]

  [event]
    name=turn 80
    {SXC_MODIFY_INCOME 6 75}
    {SXC_MODIFY_INCOME 7 165}
    {SXC_MODIFY_INCOME 8 165}
    {SXC_MODIFY_INCOME 9 210}
  [/event]

  [event]
    name=turn 90
    {SXC_MODIFY_INCOME 6 80}
    {SXC_MODIFY_INCOME 7 180}
    {SXC_MODIFY_INCOME 8 180}
    {SXC_MODIFY_INCOME 9 230}
  [/event]

  [event]
    name=turn 100
    {SXC_MODIFY_INCOME 6 85}
    {SXC_MODIFY_INCOME 7 195}
    {SXC_MODIFY_INCOME 8 195}
    {SXC_MODIFY_INCOME 9 250}
  [/event]

  [event]
    name=turn 110
    {SXC_MODIFY_INCOME 6 90}
    {SXC_MODIFY_INCOME 7 210}
    {SXC_MODIFY_INCOME 8 210}
    {SXC_MODIFY_INCOME 9 270}
  [/event]

  [event]
    name=turn 120
    {SXC_MODIFY_INCOME 6 95}
    {SXC_MODIFY_INCOME 7 225}
    {SXC_MODIFY_INCOME 8 225}
    {SXC_MODIFY_INCOME 9 290}
  [/event]

  [event]
    name=turn 130
    {SXC_MODIFY_INCOME 6 100}
    {SXC_MODIFY_INCOME 7 240}
    {SXC_MODIFY_INCOME 8 240}
    {SXC_MODIFY_INCOME 9 310}
  [/event]

  [event]
    name=turn 140
    {SXC_MODIFY_INCOME 6 105}
    {SXC_MODIFY_INCOME 7 255}
    {SXC_MODIFY_INCOME 8 255}
    {SXC_MODIFY_INCOME 9 330}
  [/event]

  [event]
    name=turn 22
    {SXC_ENEMY_BOSS CHEST_GOLD 100 48 2 "Dwarvish Sentinel" 9 -1 932 0 21 1 19 10 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS CHEST_GOLD 100 6 4 "Orcish Warlord" 8 -2 926 1 24 0 24 10 RP BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS CHEST_GOLD 100 20 21 "Orcish Warlord" 8 -2 926 1 24 0 24 10 RP BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS CHEST_GOLD 100 33 21 "Spectre" 7 -4 967 0 23 0 18 10 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS CHEST_GOLD 100 50 45 "Drake Blademaster" 6 -3 920 0 14 0 22 10 BLANK BLANK BLANK BLANK}
  [/event]

  [event]
    name=turn 42
    {SXC_ENEMY_BOSS RED_POTION 0 48 2 "Dwarvish Sentinel" 9 0 1182 1 26 2 24 10 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS RED_POTION 0 6 4 "Orcish Warlord" 8 -1 1176 2 29 1 29 10 RP BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS RED_POTION 0 20 21 "Orcish Warlord" 8 -1 1176 2 29 1 29 10 RP BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS RED_POTION 0 33 21 "Spectre" 7 -3 1217 1 28 1 23 10 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS RED_POTION 0 50 45 "Drake Blademaster" 6 -2 1170 1 19 1 27 10 BLANK BLANK BLANK BLANK}
  [/event]

  [event]
    name=turn 61
    {SXC_ENEMY_BOSS CHEST_GOLD 150 48 2 "Dwarvish Sentinel" 9 1 1432 2 31 3 29 20 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS CHEST_GOLD 150 6 4 "Orcish Warlord" 8 0 1426 3 34 2 34 20 RP BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS CHEST_GOLD 150 20 21 "Orcish Warlord" 8 0 1426 3 34 2 34 20 RP BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS CHEST_GOLD 150 33 21 "Spectre" 7 -2 1467 2 33 2 28 20 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS CHEST_GOLD 150 50 45 "Drake Blademaster" 6 -1 1420 2 24 2 32 20 BLANK BLANK BLANK BLANK}
  [/event]

  [event]
    name=turn 80
    {SXC_ENEMY_BOSS RED_POTION 0 48 2 "Dwarvish Sentinel" 9 2 1682 3 36 4 34 20 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS RED_POTION 0 6 4 "Orcish Warlord" 8 1 1676 4 39 3 39 20 RP BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS RED_POTION 0 20 21 "Orcish Warlord" 8 1 1676 4 39 3 39 20 RP BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS RED_POTION 0 33 21 "Spectre" 7 -1 1717 3 38 3 33 20 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS RED_POTION 0 50 45 "Drake Blademaster" 6 0 1670 3 29 3 37 20 BLANK BLANK BLANK BLANK}
  [/event]

  [event]
    name=turn 100
    {SXC_ENEMY_BOSS CHEST_GOLD 200 48 2 "Dwarvish Sentinel" 9 3 1932 4 41 5 39 30 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS CHEST_GOLD 200 6 4 "Orcish Warlord" 8 2 1926 5 44 4 44 30 RP BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS CHEST_GOLD 200 20 21 "Orcish Warlord" 8 2 1926 5 44 4 44 30 RP BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS CHEST_GOLD 200 33 21 "Spectre" 7 0 1967 4 43 4 38 30 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS CHEST_GOLD 200 50 45 "Drake Blademaster" 6 1 1920 4 34 4 42 30 BLANK BLANK BLANK BLANK}
  [/event]

  [event]
    name=turn 120
    {SXC_ENEMY_BOSS RED_POTION 0 48 2 "Dwarvish Sentinel" 9 4 2182 5 46 6 44 30 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS RED_POTION 0 6 4 "Orcish Warlord" 8 3 2176 6 49 5 49 30 RP BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS RED_POTION 0 20 21 "Orcish Warlord" 8 3 2176 6 49 5 49 30 RP BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS RED_POTION 0 33 21 "Spectre" 7 1 2217 5 48 5 43 30 BLANK BLANK BLANK BLANK}
    {SXC_ENEMY_BOSS RED_POTION 0 50 45 "Drake Blademaster" 6 2 2170 5 39 5 47 30 BLANK BLANK BLANK BLANK}
  [/event]

  {SXCP_CHOOSE_MAP_VARIANT 25 49}
  {SXC_CHOOSE_DIFFICULTY 25 47}
  {SXC_INCOME_BONUS 20 20 20 20}

  #----------------
  # Drain switches (lower the water)
  #----------------
  [event]
    name=moveto
    [filter]
      x,y=43,9
      [filter_side]
        team_name=Heroes
      [/filter_side]
      [or]
        x,y=41,13
        [filter_side]
          team_name=Heroes
        [/filter_side]
      [/or]
    [/filter]
    [sound]
      # this isn't water, but it's the closest in core Wesnoth to a large mass moving
      name=cave-in.ogg
    [/sound]
    [message]
      speaker=unit
      message= _ "I've opened the sluice"
    [/message]
    {VARIABLE sxcp_stream_sluice_open yes}
    [fire_event]
      name=sxcp_recalculate_lake_and_stream_water_levels
    [/fire_event]
  [/event]

  [event]
    name=moveto
    [filter]
      x,y=19,29
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    [message]
      speaker=unit
      message= _ "This lever says 'drain control', what does it do?"
    [/message]
    [fire_event]
      name=sxcp_water_cuttlefish_cave_drained
    [/fire_event]
    [if]
      {SXC_CMP sxcp_lake_sluice_open boolean_equals no}
      [then]
        [message]
          speaker=unit
          message= _ "I heard a lot of water move in this cave, but it didn't sound enough to be the lake"
        [/message]
      [/then]
    [/if]
  [/event]

  # Killing the sea serpent opens a ford to access the boss behind
  [event]
    name=die
    first_time_only=yes
    [filter]
      x,y=19,41
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {MODIFY_TERRAIN Wwf 18 40}
    {SXC_REDRAW_TERRAIN}
  [/event]

  [event]
    name=moveto
    [filter]
      x,y=18,41
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      # this isn't water, but it's the closest in core Wesnoth to a large mass moving
      name=cave-in.ogg
    [/sound]
    [if]
      {SXC_CMP unit.movement_costs.deep_water equals 1}
      [and]
        {SXC_CMP unit.flying boolean_equals no}
      [/and]
      [then]
        [message]
          speaker=unit
          message= _ "I hope we can refill this lake afterwards"
        [/message]
      [/then]
      [else]
        [message]
          speaker=unit
          message= _ "Finally, the sluice to drain this lake"
        [/message]
      [/else]
    [/if]
    {VARIABLE sxcp_lake_sluice_open yes}
    [fire_event]
      name=sxcp_recalculate_lake_and_stream_water_levels
    [/fire_event]
  [/event]

  #----------------
  # Treasure switch
  #----------------

  [event]
    name=moveto
    [filter]
      # Opening the cave east of the entry hall, towards the drakes One switch is in the two-enemy
      # cave between the entry hall and the sea-serpent, the others are for players entering the
      # cave from the drakes' area, one is next to the wall it opens, the other is under the ghoul.
      x=21,29,30
      y=44,47,48
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {REPEAT 3 (
      {QUAKE "rumble.ogg"}
    )}
    {MODIFY_TERRAIN Uu 28 46}
    {SXC_REDRAW_TERRAIN}
  [/event]

  {SET_LABEL 25 43 "Welcome"}
  [event]
    name=moveto
    [filter]
      x,y=25,43
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {QUAKE "rumble.ogg"}
    {MODIFY_TERRAIN Rp 21 42}
    {MODIFY_TERRAIN Rp 23 45}
    {MODIFY_TERRAIN Rp 24 43}
    {MODIFY_TERRAIN Rp 24 44}
    {MODIFY_TERRAIN Rp 26 43}
    {MODIFY_TERRAIN Rp 26 44}
    {MODIFY_TERRAIN Rp 27 45}
    {SXC_REDRAW_TERRAIN}
    [message]
      speaker=unit
      message= _ "What the..."
    [/message]
    [message]
      x,y=23,44
      message= _ "Boss, I think the saurians' door only opens from the other side"
    [/message]
    [message]
      x,y=23,43
      message= _ "Well, at least we've some adventurers to mug while we find it"
    [/message]
  [/event]

  [event]
    name=moveto
    [filter]
      x=34,35
      y=42,46
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {REPEAT 3 (
      {QUAKE "rumble.ogg"}
    )}
    {MODIFY_TERRAIN Uu 35 45}
    {SXC_REDRAW_TERRAIN}
  [/event]

  [event]
    name=moveto
    [filter]
      x=35,38
      y=48,48
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {REPEAT 3 (
      {QUAKE "rumble.ogg"}
    )}
    {MODIFY_TERRAIN Uu 37 48}
    {SXC_REDRAW_TERRAIN}
  [/event]

  [event]
    name=moveto
    [filter]
      x,y=6,35
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {REPEAT 3 (
      {QUAKE "rumble.ogg"}
    )}
    {MODIFY_TERRAIN Uu 6 46}
    {SXC_REDRAW_TERRAIN}
  [/event]

  [event]
    name=moveto
    [filter]
      x,y=3,46
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {REPEAT 3 (
      {QUAKE "rumble.ogg"}
    )}
    {MODIFY_TERRAIN Uu 19 46}
    {SXC_REDRAW_TERRAIN}
  [/event]

  [event]
    name=die
    [filter]
      x,y=11,31
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {QUAKE "rumble.ogg"}
    {MODIFY_TERRAIN Uu 3 30}
    {SXC_REDRAW_TERRAIN}
  [/event]

  [event]
    name=die
    [filter]
      x,y=8,26
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {QUAKE "rumble.ogg"}
    {MODIFY_TERRAIN Uu 2 23}
    {SXC_REDRAW_TERRAIN}
  [/event]

  # Make this shop visible without hunting for switches, but it has mobile guards
  [event]
    name=prestart
    {MODIFY_TERRAIN Uu 4 20}
  [/event]

  # The chest near the west shop, opens the long chain of (currently non-moving) guards
  [event]
    name=exit_hex
    [filter]
      x,y=1,17
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {REPEAT 3 (
      {QUAKE "rumble.ogg"}
    )}
    {MODIFY_TERRAIN Re 22 21}
    {SXC_REDRAW_TERRAIN}
  [/event]

  #{SET_LABEL 2 13 "Switch"}
  #{SET_LABEL 2 14 "Switch"}
  #{SET_LABEL 3 15 "Switch"}
  [event]
    name=moveto
    [filter]
      x=2,2,3
      y=13,14,15
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {REPEAT 3 (
      {QUAKE "rumble.ogg"}
    )}
    {MODIFY_TERRAIN Re 4 16}
    {MODIFY_TERRAIN Re 5 17}
    {MODIFY_TERRAIN Re 6 16}
    {SXC_REDRAW_TERRAIN}
  [/event]

  [event]
    name=moveto
    [filter]
      x,y=6,2
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {REPEAT 3 (
      {QUAKE "rumble.ogg"}
    )}
    {MODIFY_TERRAIN Re 4 7}
    {MODIFY_TERRAIN Re 4 8}
    {SXC_REDRAW_TERRAIN}
  [/event]

  # Orc's treasure trail chest 1
  [event]
    name=moveto
    [filter]
      x,y=1,8
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {REPEAT 3 (
      {QUAKE "rumble.ogg"}
    )}
    {MODIFY_TERRAIN Re 8 7}
    {MODIFY_TERRAIN Re 8 8}
    {SXC_REDRAW_TERRAIN}
  [/event]

  # Orc's treasure trail chest 2
  [event]
    name=moveto
    [filter]
      x,y=11,8
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {REPEAT 3 (
      {QUAKE "rumble.ogg"}
    )}
    {MODIFY_TERRAIN Re 11 12}
    {SXC_REDRAW_TERRAIN}
  [/event]

  # Orc's treasure trail chest 3, flying units can get this before killing the boss
  [event]
    name=moveto
    [filter]
      x,y=14,8
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {REPEAT 3 (
      {QUAKE "rumble.ogg"}
    )}
    {MODIFY_TERRAIN Re 15 9}
    {SXC_REDRAW_TERRAIN}
    [message]
      speaker=unit
      message= _ "I hope this leads to the orcs' treasure room"
    [/message]
  [/event]

  [event]
    name=moveto
    [filter]
      x,y=47,49
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {REPEAT 3 (
      {QUAKE "rumble.ogg"}
    )}
    {MODIFY_TERRAIN Ss 48 44}
    {SXC_REDRAW_TERRAIN}
  [/event]

  # the room with the northern shop, every floor tile
  # except for the shop itself, and also the hex south
  # of the wall, where the shallow version puts a chest
  [event]
    name=moveto
    [filter]
      x=32,33,34,35
      y=5,6,5,7
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    {QUAKE "rumble.ogg"}
    {MODIFY_TERRAIN Rp 35 5}
    {SXC_REDRAW_TERRAIN}
  [/event]

  [event]
    name=moveto
    [filter]
      x=30,35
      y=5,2
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    {QUAKE "rumble.ogg"}
    {MODIFY_TERRAIN Rp 31 5}
    {SXC_REDRAW_TERRAIN}
  [/event]

  [event]
    name=moveto
    [filter]
      x=27,29
      y=5,5
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    {QUAKE "rumble.ogg"}
    {MODIFY_TERRAIN Rp 28 5}
    {SXC_REDRAW_TERRAIN}
  [/event]

  [event]
    name=moveto
    [filter]
      x=27,29
      y=6,7
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    {QUAKE "rumble.ogg"}
    {MODIFY_TERRAIN Rp 28 6}
    {SXC_REDRAW_TERRAIN}
  [/event]


  [event]
    name=moveto
    [filter]
      x,y=30,4
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    {QUAKE "rumble.ogg"}
    {MODIFY_TERRAIN Rp 31 4}
    {SXC_REDRAW_TERRAIN}
  [/event]

  [event]
    name=moveto
    [filter]
      x,y=31,2
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    {QUAKE "rumble.ogg"}
    {MODIFY_TERRAIN Rp 30 2}
    {SXC_REDRAW_TERRAIN}
  [/event]

  # The dwarvish treasury is opened by the boss' hex, and also by the northern guard's castle
  [event]
    name=moveto
    [filter]
      x=38,44
      y=1,1
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {REPEAT 3 (
      {QUAKE "rumble.ogg"}
    )}
    {MODIFY_TERRAIN Ur 49 8}
    {MODIFY_TERRAIN Ur 49 9}
    {SXC_REDRAW_TERRAIN}
  [/event]

  # Bridge south from the dwarves' room
  [event]
    name=moveto
    [filter]
      x=38,39
      y=6,7
      [filter_side]
        team_name=Heroes
      [/filter_side]
    [/filter]
    [sound]
      name=gunshot.wav
    [/sound]
    {QUAKE "rumble.ogg"}
    {MODIFY_TERRAIN Ur 39 8}
    {SXC_REDRAW_TERRAIN}
  [/event]

[/multiplayer]
